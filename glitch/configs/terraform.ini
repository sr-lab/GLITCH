[security]
suspicious_words = ["bug", "debug", "todo", "to-do", "to_do", "to be implemented", "fix",
        "issue", "issues", "problem", "solve", "hack", "ticket", "later", "incorrect", "fixme"]
passwords = ["pass", "pwd", "password", "passwd", "passno", "pass-no", "pass_no"]
users = ["root", "user", "uname", "username", "user-name", "user_name", "owner-name", 
            "owner_name", "admin", "login", "userid", "loginid"]
profile = ["user-profile"]
secrets = ["auth_token", "authetication_token","auth-token", "authentication-token", 
    "secret", "uuid", "crypt", "certificate", "token", "ssh_key", "md5", 
        "rsa", "ssl_content", "ca_content", "ssl-content", "ca-content", 
            "ssh_key_content", "ssh-key-content", "ssh_key_public", 
                "ssh-key-public", "ssh_key_private", "ssh-key-private", 
                    "ssh_key_public_content", "ssh_key_private_content", 
                        "ssh-key-public-content", "ssh-key-private-content", "raw_key"]
misc_secrets = []
roles = []
download_extensions = [] 
ssh_dirs = ["source", "destination", "path", "directory", "src", "dest", "file"]
admin = ["admin", "root"]
checksum = []
weak_crypt = ["md5", "sha1", "arcfour"]
weak_crypt_whitelist = ["checksum"]
url_http_white_list = ["localhost", "127.0.0.1"]
sensitive_data = ["user_data", "container_definitions", "custom_data"]
secret_value_assign = ["key_id=", "access_key=", "key=", "database_password=", "password=", "\"name\": \"database_password\""]

policy_keywords = ["policy"]
policy_insecure_access_control = [{"keyword": "\"principal\":", "value": "\"\\*\""},
    {"keyword": "\"action\":", "value": "\"\\*\""}]
policy_authentication = [{"au_type": ["resource.aws_iam_group_policy"], "keyword": "\"aws:multifactorauthpresent\":", 
    "value": "\\[\"true\"\\]"}]

configuration_keywords = ["configuration"]
encrypt_configuration = [{"au_type": ["resource.aws_emr_security_configuration"], 
        "keyword": "\"enableatrestencryption\":", "value": "true", "required": "yes"}, 
    {"au_type": ["resource.aws_emr_security_configuration"], "keyword": "\"enableintransitencryption\":",
        "value": "true", "required": "yes"},
    {"au_type": ["resource.aws_emr_security_configuration"], "keyword": "\"encryptionmode\":",
        "value": "\"sse-kms\"", "required": "yes"},
    {"au_type": ["resource.aws_emr_security_configuration"], "keyword": "\"encryptionkeyprovidertype\":",
        "value": "\"\"", "required": "must_not_exist"},
    {"au_type": ["resource.aws_emr_security_configuration"], "keyword": "\"awskmskey\":",
        "value": "\"\"", "required": "must_not_exist"}]

secrets_white_list = ["cloudfront_default_certificate", "client_cert_enabled", "api_key_required", "issue_client_certificate",
    "kms_key_id", "kms_key_arn", "key_arn", "performance_insights_kms_key_id", "kms_master_key_id", "kms_key_self_link", "bypass",
    "enable_key_rotation", "storage_account_access_key_is_secondary", "key_pair", "default_kms_key_name"]

github_actions_resources = ["resource.github_actions_environment_secret", 
    "resource.github_actions_organization_secret", "resource.github_actions_secret"]

integrity_policy = [{"au_type": ["resource.google_compute_instance"], "attribute": "enable_integrity_monitoring",
        "parents": ["shielded_instance_config"], "values": ["true"], "required": "no"},
    {"au_type": ["resource.google_compute_instance"], "attribute": "enable_vtpm", 
        "parents": ["shielded_instance_config"], "values": ["true"], "required": "no"},
    {"au_type": ["resource.aws_ecr_repository"], "attribute": "image_tag_mutability", "parents": [""],
        "values": ["immutable"], "required": "yes", "msg": "image_tag_mutability"}]

ensure_https = [{"au_type": ["resource.aws_cloudfront_distribution"], "attribute": "viewer_protocol_policy", 
        "parents": ["default_cache_behavior", "ordered_cache_behavior"], "values":["redirect-to-https", "https-only"], 
        "required": "yes", "msg": "cache_behavior.viewer_protocol_policy"},
    {"au_type": ["resource.aws_elasticsearch_domain"], "attribute": "enforce_https", "parents": ["domain_endpoint_options"],
        "values": ["true"], "required": "yes", "msg": "domain_endpoint_options.enforce_https"},
    {"au_type": ["resource.aws_alb_listener", "resource.aws_lb_listener"], "attribute": "protocol", "parents": [""], 
        "values": ["https", "tls"], "required": "yes", "msg": "protocol"},
    {"au_type": ["resource.azurerm_app_service", "resource.azurerm_app_service_slot", "resource.azurerm_function_app",
        "resource.azurerm_function_app_slot", "resource.azurerm_linux_web_app", "resource.azurerm_windows_web_app"], 
        "attribute": "https_only", "parents": [""], "values": ["true"], "required": "yes", "msg": "https_only"},
    {"au_type": ["resource.azurerm_storage_account"], "attribute": "enable_https_traffic_only", 
        "parents": [""], "values": ["true"], "required": "no"},
    {"au_type": ["resource.digitalocean_loadbalancer"], "attribute": "entry_protocol",
        "parents": ["forwarding_rule"], "values": ["https"], "required": "no"}]

ssl_tls_policy = [{"au_type": ["resource.aws_api_gateway_domain_name"], "attribute": "security_policy", 
        "parents": [""], "values": ["tls_1_2", "tls_1_3"], "required": "yes", "msg": "security_policy"},
    {"au_type": ["resource.aws_cloudfront_distribution"], "attribute": "minimum_protocol_version", 
        "parents": ["viewer_certificate"], "values": ["tlsv1.2_2018", "tlsv1.2_2019", "tlsv1.2_2021"], "required": "yes",
        "msg": "viewer_certificate.minimum_protocol_version"},
    {"au_type": ["resource.aws_elasticsearch_domain"], "attribute": "tls_security_policy", 
        "parents": ["domain_endpoint_options"], "values": ["policy-min-tls-1-2-2019-07"], "required": "yes",
        "msg": "domain_endpoint_options.tls_security_policy"},
    {"au_type": ["resource.aws_alb_listener", "resource.aws_lb_listener"], "attribute": "ssl_policy", "parents": [""], 
        "values": ["elbsecuritypolicy-tls-1-2-2017-01", "elbsecuritypolicy-tls-1-2-ext-2018-06"], "required": "no"},
    {"au_type": ["resource.azurerm_app_service", "resource.azurerm_app_service_slot", "resource.azurerm_function_app"],
        "parents": ["site_config"], "attribute": "min_tls_version", "values": ["1.2"], "required": "no"},
    {"au_type": ["resource.google_compute_ssl_policy"], "attribute": "min_tls_version", "parents": [""],  
        "values": ["tls_1_2"], "required": "yes", "msg": "min_tls_version"},
    {"au_type": ["resource.azurerm_postgresql_server", "resource.azurerm_mariadb_server", "resource.azurerm_mysql_server"], 
        "attribute": "ssl_enforcement_enabled", "parents": [""], "values": ["true"], "required": "yes",
        "msg": "ssl_enforcement_enabled"},
    {"au_type": ["resource.azurerm_mysql_server", "resource.azurerm_postgresql_server"],
        "attribute": "ssl_minimal_tls_version_enforced", "parents": [""], "values": ["tls1_2"], "required": "no"},
    {"au_type": ["resource.azurerm_mssql_server"], "attribute": "minimum_tls_version", 
        "parents": [""], "values": ["1.2"], "required": "no"},
    {"au_type": ["resource.google_sql_database_instance"], "attribute": "ip_configuration", "parents": ["settings"],
        "values": [""], "required": "yes", "msg": "settings.ip_configuration.require_ssl"},
    {"au_type": ["resource.google_sql_database_instance"], "attribute": "require_ssl", "parents": ["ip_configuration"],
        "values": ["true"], "required": "yes", "msg": "settings.ip_configuration.require_ssl"},
    {"au_type": ["resource.azurerm_app_service"], "attribute": "client_cert_enabled", "parents": [""],
        "values": ["true"], "required": "yes", "msg": "client_cert_enabled"},
    {"au_type": ["resource.azurerm_storage_account"], "attribute": "min_tls_version", "parents": [""],
        "values": ["tls1_2"], "required": "no"}]

ensure_dnssec = [{"au_type": ["resource.google_dns_managed_zone"], "attribute": "state",
        "parents": ["dnssec_config"], "values": ["on"], "required": "yes", "msg": "dnssec_config.state"}]

use_public_ip = [{"au_type": ["resource.aws_launch_configuration", "resource.aws_instance"],
        "attribute": "associate_public_ip_address", "parents": [""], "values": ["false"], "required": "no"},
    {"au_type": ["resource.aws_subnet"], "attribute": "map_public_ip_on_launch", "parents": [""],
        "values": ["false"], "required": "no"},
    {"au_type": ["resource.google_compute_instance"], "attribute": "access_config", "parents": ["network_interface"],
        "values": [""], "required": "must_not_exist"},
    {"au_type": ["resource.opc_compute_ip_address_reservation"], "attribute": "ip_address_pool", "parents": [""],
        "values": ["cloud-ippool"], "required": "no"}]

insecure_access_control = [{"au_type": ["resource.aws_eks_cluster"], "attribute": "endpoint_public_access",
        "parents": ["vpc_config"], "values": ["false"], "required": "yes", "msg": "vpc_config.endpoint_public_access"},
    {"au_type": ["resource.aws_eks_cluster"], "attribute": "public_access_cidrs[0]", "parents": ["vpc_config"],
        "values": [""], "required": "yes", "msg": "vpc_config.public_access_cidrs"},
    {"au_type": ["resource.aws_lambda_permission"], "attribute": "source_arn", "parents": [""],
        "values": [""], "required": "yes", "msg": "source_arn"},
    {"au_type": ["resource.aws_db_instance", "resource.aws_rds_cluster_instance"], "attribute": "publicly_accessible", "parents": [""],
        "values": ["false"], "required": "no"},
    {"au_type": ["resource.aws_s3_bucket_public_access_block"], "attribute": "block_public_acls", "parents": [""],
        "values": ["true"], "required": "yes", "msg": "block_public_acls"},
    {"au_type": ["resource.aws_s3_bucket_public_access_block"], "attribute": "block_public_policy", "parents": [""],
        "values": ["true"], "required": "yes", "msg": "block_public_policy"},
    {"au_type": ["resource.aws_s3_bucket_public_access_block"], "attribute": "restrict_public_buckets", "parents": [""],
        "values": ["true"], "required": "yes", "msg": "restrict_public_buckets"},
    {"au_type": ["resource.aws_s3_bucket_public_access_block"], "attribute": "ignore_public_acls", "parents": [""],
        "values": ["true"], "required": "yes", "msg": "ignore_public_acls"},
    {"au_type": ["resource.aws_s3_bucket"], "attribute": "acl", "parents": [""], 
        "values": ["private", "aws-exec-read", "log-delivery-write"], "required": "no"},
    {"au_type": ["resource.azurerm_kubernetes_cluster"], "attribute": "authorized_ip_ranges[0]", 
        "parents": ["api_server_access_profile"], "values": [""], "required": "yes", 
        "msg": "api_server_access_profile.authorized_ip_ranges"},
    {"au_type": ["resource.azurerm_postgresql_server", "resource.azurerm_mariadb_server", "resource.azurerm_mssql_server",
        "resource.azurerm_mysql_server"], "attribute": "public_network_access_enabled", "parents": [""], 
        "values": ["false"], "required": "yes", "msg": "public_network_access_enabled"},
    {"au_type": ["resource.azurerm_data_factory"], "attribute": "public_network_enabled", "parents": [""], 
        "values": ["false"], "required": "yes", "msg": "public_network_enabled"},
    {"au_type": ["resource.digitalocean_spaces_bucket"], "attribute": "acl", "parents": [""], 
        "values": ["private"], "required": "yes", "msg": "acl"},
    {"au_type": ["resource.digitalocean_spaces_bucket_object"], "attribute": "acl", "parents": [""], 
        "values": ["private"], "required": "no"},
    {"au_type": ["resource.google_bigquery_dataset"], "attribute": "special_group", "parents": ["access"], 
        "values": ["projectowners", "projectreaders", "projectwriters"], "required": "no"},
    {"au_type": ["resource.google_container_cluster"], "attribute": "enable_private_nodes", 
        "parents": ["private_cluster_config"], "values": ["true"], "required": "yes", 
        "msg": "private_cluster_config.enable_private_nodes"},
    {"au_type": ["resource.aws_mq_broker"], "attribute": "publicly_accessible", "parents": [""], "values": ["false"], 
        "required": "no"},
    {"au_type": ["resource.aws_athena_workgroup"], "attribute": "enforce_workgroup_configuration", 
        "parents": ["configuration"], "values": ["true"], "required": "no"},
    {"au_type": ["resource.azurerm_kubernetes_cluster"], "attribute": "role_based_access_control_enabled", 
        "parents": [""], "values": ["true"], "required": "no"},
    {"au_type": ["resource.google_container_cluster"], "attribute": "enable_legacy_abac", 
        "parents": [""], "values": ["false"], "required": "no"},
    {"au_type": ["resource.google_storage_bucket"], "attribute": "uniform_bucket_level_access", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "uniform_bucket_level_access"},
    {"au_type": ["resource.google_compute_instance"], "attribute": "email", 
        "parents": ["service_account"], "values": [""], "required": "yes", "msg": "service_account.email"},
    {"au_type": ["resource.azurerm_storage_container"], "attribute": "container_access_type", "parents": [""], 
        "values": ["private"], "required": "no"}]
    
authentication = [{"au_type": ["resource.azurerm_app_service", "resource.azurerm_function_app"], "attribute": "enabled",
        "parents": ["auth_settings"], "values": ["true"], "required": "yes", "msg": "auth_settings.enabled"},
    {"au_type": ["resource.azurerm_linux_virtual_machine", "resource.azurerm_linux_virtual_machine_scale_set"],
        "attribute": "disable_password_authentication", "parents": [""], "values": ["true"], "required": "no"},
    {"au_type": ["resource.azurerm_virtual_machine"], "attribute": "disable_password_authentication",
        "parents": ["os_profile_linux_config"], "values": ["true"], "required": "yes", 
        "msg": "os_profile_linux_config.disable_password_authentication"},
    {"au_type": ["resource.google_container_cluster"], "attribute": "issue_client_certificate",
        "parents": ["client_certificate_config"], "values": ["false"], "required": "no"}]
    
missing_encryption = [{"au_type": ["resource.aws_api_gateway_method_settings"], "attribute": "cache_data_encrypted", 
        "parents": ["settings"], "values": ["true"], "required": "yes", "msg": "settings.cache_data_encrypted"},
    {"au_type": ["resource.aws_athena_database"], "attribute": "encryption_option", "parents": ["encryption_configuration"], 
        "values": ["sse_kms", "sse_s3", "cse_kms"], "required": "yes", "msg": "encryption_configuration.encryption_option"},
    {"au_type": ["resource.aws_athena_workgroup"], "attribute": "result_configuration", "parents": ["configuration"], 
        "values": [""], "required": "yes", 
        "msg": "configuration.result_configuration.encryption_configuration.encryption_option"},
    {"au_type": ["resource.aws_athena_workgroup"], "attribute": "encryption_configuration", 
        "parents": ["result_configuration"], "values": [""], "required": "yes",
        "msg": "configuration.result_configuration.encryption_configuration.encryption_option"},
    {"au_type": ["resource.aws_athena_workgroup"], "attribute": "encryption_option", "parents": ["encryption_configuration"], 
        "values": ["sse_kms", "sse_s3", "cse_kms"], "required": "yes",
        "msg": "configuration.result_configuration.encryption_configuration.encryption_option"},
    {"au_type": ["resource.aws_codebuild_project"], "attribute": "encryption_disabled",
        "parents": ["artifacts", "secondary_artifacts"], "values": ["false"], "required": "no"},
    {"au_type": ["resource.aws_docdb_cluster", "resource.aws_rds_cluster", "resource.aws_db_instance", 
        "resource.aws_db_cluster_snapshot", "resource.aws_rds_cluster_instance", "resource.aws_rds_global_cluster", 
        "resource.aws_neptune_cluster"], "attribute": "storage_encrypted", "parents": [""], "values": ["true"], 
        "required": "yes", "msg": "storage_encrypted"},
    {"au_type": ["resource.aws_dax_cluster", "resource.aws_dynamodb_table"], "attribute": "enabled", 
        "parents": ["server_side_encryption"], "values": ["true"], "required": "yes", "msg": "server_side_encryption.enabled"},
    {"au_type": ["resource.aws_ebs_volume", "resource.aws_efs_file_system"], "attribute": "encrypted", "parents": [""], 
        "values": ["true"], "required": "yes", "msg": "encrypted"},
    {"au_type": ["resource.aws_instance", "resource.aws_launch_configuration"], "attribute": "encrypted", 
        "parents": ["root_block_device"], "values": ["true"], "required": "yes", "msg": "root_block_device.encrypted"},
    {"au_type": ["resource.aws_instance", "resource.aws_launch_configuration"], "attribute": "encrypted", 
        "parents": ["ebs_block_device"], "values": ["true"], "required": "no"},
    {"au_type": ["resource.aws_ami"], "attribute": "encrypted", 
        "parents": ["ebs_block_device", "root_block_device"], "values": ["true"], "required": "no"},
    {"au_type": ["resource.aws_ecs_task_definition"], "attribute": "transit_encryption", 
        "parents": ["efs_volume_configuration"], "values": ["enabled"], "required": "no"},
    {"au_type": ["resource.aws_eks_cluster"], "attribute": "provider", "parents": ["encryption_config"], 
        "values": [""], "required": "yes", "msg": "encryption_config.provider.key_arn"},
    {"au_type": ["resource.aws_eks_cluster"], "attribute": "key_arn", "parents": ["provider"], "values": ["any_not_empty"], 
        "required": "yes", "msg": "encryption_config.provider.key_arn"},
    {"au_type": ["resource.aws_elasticsearch_domain"], "attribute": "enabled", "parents": ["encrypt_at_rest"],
        "values": ["true"], "required": "yes", "msg": "encrypt_at_rest.enabled"},
    {"au_type": ["resource.aws_elasticache_replication_group"], "attribute": "at_rest_encryption_enabled", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "at_rest_encryption_enabled"},
    {"au_type": ["resource.aws_kinesis_stream"], "attribute": "encryption_type", 
        "parents": [""], "values": ["kms"], "required": "yes", "msg": "encryption_type"},
    {"au_type": ["resource.aws_msk_cluster"], "attribute": "encryption_in_transit", "parents": ["encryption_info"],
        "values": [""], "required": "yes", "msg": "encryption_info.encryption_in_transit"},
    {"au_type": ["resource.aws_msk_cluster"], "attribute": "client_broker", 
        "parents": ["encryption_in_transit"], "values": ["tls"], "required": "no"},
    {"au_type": ["resource.aws_msk_cluster"], "attribute": "in_cluster", 
        "parents": ["encryption_in_transit"], "values": ["true"], "required": "no"},
    {"au_type": ["resource.aws_redshift_cluster"], "attribute": "encrypted", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "encrypted"},
    {"au_type": ["resource.aws_workspaces_workspace"], "attribute": "root_volume_encryption_enabled", "parents": [""], 
        "values": ["true"], "required": "yes", "msg": "root_volume_encryption_enabled"},
    {"au_type": ["resource.aws_workspaces_workspace"], "attribute": "user_volume_encryption_enabled", "parents": [""], 
        "values": ["true"], "required": "yes", "msg": "user_volume_encryption_enabled"},
    {"au_type": ["resource.aws_elasticsearch_domain"], "attribute": "enabled", "parents": ["node_to_node_encryption"], 
        "values": ["true"], "required": "yes", "msg": "node_to_node_encryption.enabled"},
    {"au_type": ["resource.aws_elasticache_replication_group"], "attribute": "transit_encryption_enabled", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "transit_encryption_enabled"},
    {"au_type": ["resource.aws_ecr_repository"], "attribute": "encryption_type", "parents": ["encryption_configuration"], 
        "values": ["kms"], "required": "yes", "msg": "encryption_configuration.encryption_type"},
    {"au_type": ["resource.aws_s3_bucket_server_side_encryption_configuration"], 
        "attribute": "apply_server_side_encryption_by_default", "parents": ["rule"], 
        "values": [""], "required": "yes", "msg": "rule.apply_server_side_encryption_by_default.sse_algorithm"},
    {"au_type": ["resource.aws_s3_bucket_server_side_encryption_configuration"], 
        "attribute": "sse_algorithm", "parents": ["apply_server_side_encryption_by_default"], 
        "values": ["aes256", "aws:kms"], "required": "yes", "msg": "rule.apply_server_side_encryption_by_default.sse_algorithm"}]

firewall = [{"au_type": ["resource.aws_cloudfront_distribution"], "attribute": "web_acl_id", "parents": [""], 
        "values": ["any_not_empty"], "required": "yes", "msg": "web_acl_id"},
    {"au_type": ["resource.aws_alb", "resource.aws_lb", "resource.aws_elb"], "attribute": "internal", "parents": [""], "values": ["true"], 
        "required": "yes", "msg": "internal"},
    {"au_type": ["resource.aws_alb", "resource.aws_lb"], "attribute": "drop_invalid_header_fields", "parents": [""], 
        "values": ["true"], "required": "yes", "msg": "drop_invalid_header_fields"},
    {"au_type": ["resource.google_compute_instance"], "attribute": "can_ip_forward", "parents": [""], "values": ["false"],
        "required": "no"},
    {"au_type": ["resource.google_compute_firewall"], "attribute": "destination_ranges[0]", "parents": [""], "values": [""], 
        "required": "yes", "msg": "destination_ranges"},
    {"au_type": ["resource.google_compute_firewall"], "attribute": "source_ranges[0]", "parents": [""], "values": [""], 
        "required": "yes", "msg": "source_ranges"},
    {"au_type": ["resource.openstack_fw_rule_v1"], "attribute": "destination_ip_address", "parents": [""], "values": [""], 
        "required": "yes", "msg": "destination_ip_address"},
    {"au_type": ["resource.openstack_fw_rule_v1"], "attribute": "source_ip_address", "parents": [""], "values": [""], 
        "required": "yes", "msg": "source_ip_address"},
    {"au_type": ["resource.azurerm_key_vault"], "attribute": "default_action", "parents": ["network_acls"], 
        "values": ["deny"], "required": "yes", "msg": "network_acls.default_action"},
    {"au_type": ["resource.azurerm_key_vault"], "attribute": "bypass", "parents": ["network_acls"], 
        "values": ["azureservices"], "required": "yes", "msg": "network_acls.bypass"},
    {"au_type": ["resource.google_container_cluster"], "attribute": "cidr_blocks", "parents": ["master_authorized_networks_config"], 
      "values": [""], "required": "yes", "msg": "master_authorized_networks_config.cidr_blocks.cidr_block"},
    {"au_type": ["resource.google_container_cluster"], "attribute": "cidr_block", "parents": ["cidr_blocks"], 
      "values": [""], "required": "yes", "msg": "master_authorized_networks_config.cidr_blocks.cidr_block"}]

missing_threats_detection_alerts = [{"au_type": ["resource.azurerm_mssql_server_security_alert_policy"], 
        "attribute": "disabled_alerts[0]", "parents": [""], "values": [""], "required": "must_not_exist"},
    {"au_type": ["resource.github_repository"], "attribute": "vulnerability_alerts", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "vulnerability_alerts"},
    {"au_type": ["resource.azurerm_mssql_server_security_alert_policy"], "attribute": "email_addresses[0]", 
        "parents": [""], "values": [""], "required": "yes", "msg": "email_addresses"},
    {"au_type": ["resource.azurerm_mssql_server_security_alert_policy"], "attribute": "email_account_admins", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "email_account_admins"},
    {"au_type": ["resource.azurerm_security_center_contact"], "attribute": "alert_notifications", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "alert_notifications"},
    {"au_type": ["resource.azurerm_security_center_contact"], "attribute": "alerts_to_admins", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "alerts_to_admins"},
    {"au_type": ["resource.azurerm_security_center_contact"], "attribute": "phone", 
        "parents": [""], "values": ["any_not_empty"], "required": "yes", "msg": "phone"},
    {"au_type": ["resource.aws_ecr_repository"], "attribute": "scan_on_push", "parents": ["image_scanning_configuration"], 
        "values": ["true"], "required": "yes", "msg": "image_scanning_configuration.scan_on_push"}]

password_key_policy = [{"au_type": ["resource.aws_iam_account_password_policy"], "attribute": "password_reuse_prevention", 
        "parents": [""], "values": ["5"], "required": "yes", "msg": "password_reuse_prevention", "logic": "gte"},
    {"au_type": ["resource.aws_iam_account_password_policy"], "attribute": "require_lowercase_characters", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "require_lowercase_characters", "logic": "equal"},
    {"au_type": ["resource.aws_iam_account_password_policy"], "attribute": "require_numbers", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "require_numbers", "logic": "equal"},
    {"au_type": ["resource.aws_iam_account_password_policy"], "attribute": "require_symbols", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "require_symbols", "logic": "equal"},
    {"au_type": ["resource.aws_iam_account_password_policy"], "attribute": "require_uppercase_characters", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "require_uppercase_characters", "logic": "equal"},
    {"au_type": ["resource.aws_iam_account_password_policy"], "attribute": "max_password_age", 
        "parents": [""], "values": ["90"], "required": "yes", "msg": "max_password_age", "logic": "lte"},
    {"au_type": ["resource.aws_iam_account_password_policy"], "attribute": "minimum_password_length", 
        "parents": [""], "values": ["14"], "required": "yes", "msg": "minimum_password_length", "logic": "gte"},
    {"au_type": ["resource.azurerm_key_vault_secret"], "attribute": "expiration_date", 
        "parents": [""], "values": ["any_not_empty"], "required": "yes", "msg": "expiration_date", "logic": "equal"},
    {"au_type": ["resource.azurerm_key_vault"], "attribute": "purge_protection_enabled", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "purge_protection_enabled", "logic": "equal"},
    {"au_type": ["resource.azurerm_key_vault_key"], "attribute": "expiration_date", "parents": [""], 
        "values": ["any_not_empty"], "required": "yes", "msg": "expiration_date", "logic": "equal"}]

key_management = [{"au_type": ["resource.aws_cloudwatch_log_group", "resource.aws_docdb_cluster", "resource.aws_ebs_volume",
        "resource.aws_secretsmanager_secret", "resource.aws_kinesis_stream", "resource.aws_cloudtrail", "resource.aws_rds_cluster",
        "resource.aws_db_instance", "resource.aws_redshift_cluster", "resource.aws_db_instance_automated_backups_replication", 
        "resource.aws_rds_cluster_activity_stream"], 
        "attribute": "kms_key_id", "parents": [""], "values": ["any_not_empty"], "required": "yes", "msg": "kms_key_id"},
    {"au_type": ["resource.aws_dynamodb_table"], "attribute": "kms_key_arn", "parents": ["server_side_encryption"], 
        "values": ["any_not_empty"], "required": "yes", "msg": "server_side_encryption.kms_key_arn"},
    {"au_type": ["resource.aws_neptune_cluster"], "attribute": "kms_key_arn", "parents": [""], 
        "values": ["any_not_empty"], "required": "yes", "msg": "kms_key_arn"},
    {"au_type": ["resource.aws_ecr_repository"], "attribute": "kms_key", "parents": ["encryption_configuration"], 
        "values": ["any_not_empty"], "required": "yes", "msg": "encryption_configuration.kms_key"},
    {"au_type": ["resource.aws_kms_key"], "attribute": "enable_key_rotation", "parents": [""], 
        "values": ["true"], "required": "yes", "msg": "enable_key_rotation"},
    {"au_type": ["resource.aws_rds_cluster_instance", "resource.aws_db_instance"], "attribute": "performance_insights_kms_key_id", 
        "parents": [""], "values": ["any_not_empty"], "required": "yes", "msg": "performance_insights_kms_key_id"},
    {"au_type": ["resource.google_kms_crypto_key"], "attribute": "rotation_period", "parents": [""], 
        "values": [""], "required": "yes", "msg": "rotation_period"},
    {"au_type": ["resource.google_compute_disk"], "attribute": "kms_key_self_link", "parents": ["disk_encryption_key"], 
        "values": ["any_not_empty"], "required": "yes", "msg": "disk_encryption_key.kms_key_self_link"},
    {"au_type": ["resource.google_compute_instance"], "attribute": "kms_key_self_link", "parents": ["boot_disk"], 
        "values": ["any_not_empty"], "required": "yes", "msg": "boot_disk.kms_key_self_link"},
    {"au_type": ["resource.google_compute_instance"], "attribute": "block-project-ssh-keys", "parents": ["metadata"], 
        "values": ["true"], "required": "yes", "msg": "metadata.block-project-ssh-keys"},
    {"au_type": ["resource.aws_s3_bucket_server_side_encryption_configuration"], 
        "attribute": "apply_server_side_encryption_by_default", "parents": ["rule"], 
        "values": [""], "required": "yes", "msg": "rule.apply_server_side_encryption_by_default.kms_master_key_id"},
    {"au_type": ["resource.aws_s3_bucket_server_side_encryption_configuration"], 
        "attribute": "kms_master_key_id", "parents": ["apply_server_side_encryption_by_default"], 
        "values": ["any_not_empty"], "required": "yes", "msg": "rule.apply_server_side_encryption_by_default.kms_master_key_id"},
    {"au_type": ["resource.aws_sns_topic", "resource.aws_sqs_queue"], "attribute": "kms_master_key_id", "parents": [""], 
        "values": ["any_not_empty"], "required": "yes", "msg": "kms_master_key_id"},
    {"au_type": ["resource.digitalocean_droplet"], "attribute": "ssh_keys[0]", "parents": [""], 
        "values": [""], "required": "yes", "msg": "ssh_keys"},
    {"au_type": ["resource.google_storage_bucket"], "attribute": "default_kms_key_name", "parents": ["encryption"], 
        "values": ["any_not_empty"], "required": "yes", "msg": "encryption.default_kms_key_name"}]

network_security_rules = [{"au_type": ["resource.azurerm_storage_account_network_rules"], "attribute": "default_action", 
        "parents": [""], "values": ["deny"], "required": "yes", "msg": "default_action"},
    {"au_type": ["resource.azurerm_storage_account"], "attribute": "default_action", 
        "parents": ["network_rules"], "values": ["deny"], "required": "yes", "msg": "network_rules.default_action"},
    {"au_type": ["resource.aws_network_acl_rule"], "attribute": "protocol", 
        "parents": [""], "values": ["tcp"], "required": "no"},
    {"au_type": ["resource.azurerm_kubernetes_cluster"], "attribute": "network_policy", "parents": ["network_profile"], 
        "values": ["calico", "azure"], "required": "yes", "msg": "network_profile.network_policy"},
    {"au_type": ["resource.azurerm_synapse_workspace"], "attribute": "managed_virtual_network_enabled", "parents": [""], 
        "values": ["true"], "required": "yes", "msg": "managed_virtual_network_enabled"},
    {"au_type": ["resource.google_compute_instance"], "attribute": "serial-port-enable", "parents": ["metadata"], 
        "values": ["false"], "required": "no"},
    {"au_type": ["resource.google_container_cluster"], "attribute": "ip_allocation_policy", "parents": [""], 
        "values": [""], "required": "yes", "msg": "ip_allocation_policy"},
    {"au_type": ["resource.google_container_cluster"], "attribute": "enabled", "parents": ["network_policy"], 
        "values": ["true"], "required": "yes", "msg": "network_policy.enabled"},
    {"au_type": ["resource.google_project"], "attribute": "auto_create_network", "parents": [""], 
        "values": ["false"], "required": "yes", "msg": "auto_create_network"}]

google_iam_member_resources = ["resource.google_project_iam_member", "resource.google_project_iam_binding",
        "resource.google_organization_iam_member", "resource.google_organization_iam_binding",
        "resource.google_folder_iam_member", "resource.google_folder_iam_binding"]

permission_iam_policies = [{"au_type": ["resource.google_project_iam_member", "resource.google_project_iam_binding",
        "resource.google_organization_iam_member", "resource.google_organization_iam_binding",
        "resource.google_folder_iam_member", "resource.google_folder_iam_binding"], 
        "attribute": "role", "parents": [""], "values": ["roles/owner", "roles/editor", "roles/iam.securityadmin",
        "roles/iam.serviceaccountadmin", "roles/iam.serviceaccountkeyadmin", "roles/iam.serviceaccountuser", 
        "roles/iam.serviceaccounttokencreator", "roles/iam.workloadidentityuser", "roles/dataproc.editor",
        "roles/dataproc.admin", "roles/dataflow.developer", "roles/resourcemanager.folderadmin", 
        "roles/resourcemanager.folderiamadmin", "roles/resourcemanager.projectiamadmin", "roles/resourcemanager.organizationadmin",
        "roles/cloudasset.viewer", "roles/cloudasset.owner", "roles/serverless.serviceagent", "roles/dataproc.serviceagent"],
        "required": "no", "logic": "diff"}]

logging = [{"au_type": ["resource.aws_cloudwatch_log_group"], "attribute": "retention_in_days", "parents": [""], 
        "values": ["1", "3", "5", "7", "14", "30", "60", "90", "120", "150", "180", "365", "400", "545", "731", "1827", "3653"],
        "required": "yes", "msg": "retention_in_days"},
    {"au_type": ["resource.azurerm_storage_account"], "attribute": "logging", "parents": ["queue_properties"], 
        "values": [""], "required": "yes", "msg": "queue_properties.logging.delete"},
    {"au_type": ["resource.azurerm_storage_account"], "attribute": "logging", "parents": ["queue_properties"], 
        "values": [""], "required": "yes", "msg": "queue_properties.logging.read"},
    {"au_type": ["resource.azurerm_storage_account"], "attribute": "logging", "parents": ["queue_properties"], 
        "values": [""], "required": "yes", "msg": "queue_properties.logging.write"},
    {"au_type": ["resource.azurerm_storage_account"], "attribute": "delete", "parents": ["logging"], 
        "values": ["true"], "required": "yes", "msg": "queue_properties.logging.delete"},
    {"au_type": ["resource.azurerm_storage_account"], "attribute": "read", "parents": ["logging"], 
        "values": ["true"], "required": "yes", "msg": "queue_properties.logging.read"},
    {"au_type": ["resource.azurerm_storage_account"], "attribute": "write", "parents": ["logging"], 
        "values": ["true"], "required": "yes", "msg": "queue_properties.logging.write"},
    {"au_type": ["resource.aws_s3_bucket"], "attribute": "logging", "parents": [""], 
        "values": [""], "required": "yes", "msg": "logging"},
    {"au_type": ["resource.aws_apigatewayv2_stage", "resource.aws_api_gateway_stage"], "attribute": "destination_arn", 
        "parents": ["access_log_settings"], "values": ["any_not_empty"], "required": "yes", 
        "msg": "access_log_settings.destination_arn"},
    {"au_type": ["resource.aws_api_gateway_stage"], "attribute": "xray_tracing_enabled", "parents": [""], 
        "values": ["true"], "required": "yes", "msg": "xray_tracing_enabled"},
    {"au_type": ["resource.aws_cloudfront_distribution"], "attribute": "bucket", "parents": ["logging_config"], 
        "values": ["any_not_empty"], "required": "yes", "msg": "logging_config.bucket"},
    {"au_type": ["resource.aws_cloudtrail"], "attribute": "enable_log_file_validation", "parents": [""], 
        "values": ["true"], "required": "yes", "msg": "enable_log_file_validation"},
    {"au_type": ["resource.aws_cloudtrail"], "attribute": "cloud_watch_logs_group_arn", "parents": [""], 
        "values": [""], "required": "yes", "msg": "cloud_watch_logs_group_arn"},
    {"au_type": ["resource.aws_elasticsearch_domain"], "attribute": "log_type", "parents": ["log_publishing_options"], 
        "values": ["index_slow_logs", "search_slow_logs", "es_application_logs", "audit_logs"], "required": "yes",
        "msg": "log_publishing_options.log_type"},
    {"au_type": ["resource.aws_elasticsearch_domain"], "attribute": "enabled", "parents": ["log_publishing_options"], 
        "values": ["true"], "required": "no"},
    {"au_type": ["resource.aws_lambda_function"], "attribute": "mode", "parents": ["tracing_config"], 
        "values": ["active"], "required": "yes", "msg": "tracing_config.mode"},
    {"au_type": ["resource.aws_mq_broker"], "attribute": "audit", "parents": ["logs"], 
        "values": ["true"], "required": "yes", "msg": "logs.audit"},
    {"au_type": ["resource.aws_mq_broker"], "attribute": "general", "parents": ["logs"], 
        "values": ["true"], "required": "yes", "msg": "logs.general"},
    {"au_type": ["resource.azurerm_kubernetes_cluster"], "attribute": "oms_agent", "parents": ["addon_profile"], 
        "values": [""], "required": "yes", "msg": "addon_profile.oms_agent.log_analytics_workspace_id"},
    {"au_type": ["resource.azurerm_kubernetes_cluster"], "attribute": "log_analytics_workspace_id", "parents": ["oms_agent"], 
        "values": ["any_not_empty"], "required": "yes", "msg": "addon_profile.oms_agent.log_analytics_workspace_id"},
    {"au_type": ["resource.azurerm_network_watcher_flow_log"], "attribute": "days", "parents": ["retention_policy"], 
        "values": [""], "required": "yes", "msg": "retention_policy.days"},
    {"au_type": ["resource.azurerm_monitor_log_profile"], "attribute": "days", "parents": ["retention_policy"], 
        "values": [""], "required": "yes", "msg": "retention_policy.days"},
    {"au_type": ["resource.google_compute_subnetwork"], "attribute": "log_config", "parents": [""], 
        "values": [""], "required": "yes", "msg": "log_config"},
    {"au_type": ["resource.google_container_cluster"], "attribute": "logging_service", "parents": [""], 
        "values": ["logging.googleapis.com/kubernetes"], "required": "no"},
    {"au_type": ["resource.google_container_cluster"], "attribute": "monitoring_service", "parents": [""], 
        "values": ["monitoring.googleapis.com/kubernetes"], "required": "no"},
    {"au_type": ["resource.aws_rds_cluster_instance", "resource.aws_db_instance"], "attribute": "performance_insights_enabled", 
        "parents": [""], "values": ["true"], "required": "yes", "msg": "performance_insights_enabled"}]

google_sql_database_log_flags = [{"flag_name": "log_checkpoints", "value": "on", "required": "yes"},
    {"flag_name": "log_connections", "value": "on", "required": "yes"},
    {"flag_name": "log_disconnections", "value": "on", "required": "yes"},
    {"flag_name": "log_lock_waits", "value": "on", "required": "yes"},
    {"flag_name": "log_temp_files", "value": "0", "required": "yes"},
    {"flag_name": "log_min_messages", "value": "warning", "required": "no"},
    {"flag_name": "log_min_duration_statement", "value": "-1", "required": "no"}]

possible_attached_resources_aws_route53 = ["aws_instance", "aws_eip", "aws_elb", "aws_lb", "aws_alb", "aws_route53_record", 
        "aws_s3_bucket", "aws_api_gateway_domain_name", "aws_elastic_beanstalk_environment", "aws_vpc_endpoint", 
        "aws_globalaccelerator_accelerator", "aws_cloudfront_distribution", "aws_db_instance", "aws_apigatewayv2_domain_name", 
        "aws_lightsail_instance"]

versioning = [{"au_type": ["resource.aws_s3_bucket", "resource.digitalocean_spaces_bucket"], "attribute": "enabled", 
        "parents": ["versioning"], "values": ["true"], "required": "yes", "msg": "versioning.enabled"}]

naming = [{"au_type": ["resource.aws_security_group", "resource.aws_security_group_rule", 
        "resource.aws_elasticache_security_group", "resource.openstack_networking_secgroup_v2", 
        "resource.openstack_networking_secgroup_rule_v2"],"attribute": "description", "parents": [""], 
        "values": ["any_not_empty"], "required": "yes", "msg": "description"},
    {"au_type": ["resource.aws_security_group"], "attribute": "description",
        "parents": ["ingress", "egress"], "values": ["any_not_empty"], "required": "no"}]

replication = [{"au_type": ["resource.aws_s3_bucket_replication_configuration"], "attribute": "status",
        "parents": ["rule"], "values": ["enabled"], "required": "yes", "msg": "rule.status"}]

file_commands = ["file", "chmod", "mkdir"]
shell_resources = ["shell", "execute", "exec"]
ip_binding_commands = ["ip_bind_all"]

[design]
exec_atomic_units = ["exec"]
default_variables = []
